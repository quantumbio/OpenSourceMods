# This patch file was generated by NetBeans IDE
# This patch can be applied using context Tools: Apply Diff Patch action on respective folder.
# It uses platform neutral UTF-8 encoding.
# Above lines and this line are ignored by the patching process.
--- /home/roger/Software/check/libccp4-6.5.1/fortran/rwbrook.f
+++ /home/roger/Software/libccp4-6.5.1/fortran/rwbrook.f
@@ -2598,7 +2598,8 @@
 C     .. Scalar Arguments ..
       REAL C
       INTEGER IELEC,Ifail,IWT,NG
-      CHARACTER ID*4,IDCHK*4,STRING*200
+      CHARACTER ID*4,IDCHK*4,STRING*200,CLIBDIR*32767
+      CHARACTER*32767 LOGNAM
 C     ..
 C     .. Array Arguments ..
       REAL A(4),B(4),CU(2),MO(2)
@@ -2629,8 +2630,11 @@
       IF (IOS .NE. 0) CALL CCPERR(1,'Error opening ATOMSF file')
 
       IF (.NOT.OP) THEN
+        CALL getenv("CLIBD", CLIBDIR)
+        CLIBDIR=TRIM(ADJUSTL(CLIBDIR))
+        LOGNAM = TRIM(CLIBDIR)//'/atomsf.lib'
         Ifail  = 1
-        CALL CCPDPN(45,'ATOMSF','READONLY','F',0,Ifail)
+        CALL CCPDPN(45, LOGNAM,'READONLY','F',0,Ifail)
         IF (Ifail.LT.0) CALL CCPERR(1,'Error opening library file')
       ELSE
         REWIND 45
